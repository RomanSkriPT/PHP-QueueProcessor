# QueueProcessor
QueueProcessor - is a simple PHP abstract class for building classes which could be _instantiated_ from several places and/or _almost simultaneously_ but should _process_ passed into them data _successively_ (one by one) _between all instances_.

###### USE CASE
<hr/>
The real use case of such class is a class for API requests to a _Service_ which provides several types of requests but allows only 1 request at a time from a given source. But your application uses this Service in various occasions, some of which for instance are generated by the users of your application. So you need to be sure that if there were generated a few simultaneous events which involve performing request to a _Service_, there will be no such simultaneous requests done.

###### HOW IT WORKS
<hr/>
><em>Instead, the Event #1 walks into communication room and locks the door. Does its job there. Unlocks the door and goes out. If there were some other events, that tried to access this room, while Event #1 were there, these events forms a queue, puts their request data in a common vault, gets their unique ID and starts knocking the door with a certain interval.</em>

><em>When Event #1 walks out and another event gets lucky to pass in, it walks in and locks the door. But before this Event X stats doing its own thing, since it's really honest, it checks the queue list. If there are any other events, that are higher in the queue than Event X, then Event X gets their data from the vault, sends it, receives response and writes it down in the temporary journal signing with unique ID of each event-owner. Then Event X does its own job, unlocks the door and walks out.</em>

><em>The other events, while knocking the door of communication room also checks the temporary journal to find out if there is a response to their request data, in case some slyboots slipped before them into the room. If they finds what belongs to them, the takes it out and walks away.</em>

###### THE CODE
<hr/>
So `YouCustomClass` extended from `QueueProcessor` should implement two methods:
* `_getQueueStaticDataDirRoot()` - should return a string with a full path to a directory where `QueueProcessor` will create a 'queue_data' directory to store all queue data for `YouCustomClass`. You can return a `__DIR__` to store that data within a parent directory of your class.
* `_processRequest($data)` - this is the main processing method of incoming data to `YouCustomClass` instance. This is where you should implement all the logic of processing of a single request data. This method will be executed when the turn of a given instance of `YouCustomClass` will come.

Thus here is a basic example of child class:
```PHP
class YouCustomClass extends QueueProcessor {

    /**
     * Public execution callback.
     * @param mixed $data Request's data
     * @return mixed
     */
    public function execute($data) {
        return $this->_processRequest($data);
    }

    /**
     * Return class' directory path.
     * @return string
     */
    protected function _getQueueStaticDataDirRoot() {
        return __DIR__;
	}
	  
    /**
     * Main request data processor.
     * @param mixed $data Request's data
     * @return mixed
     */
    protected function _processRequest($data) {
        $result = FALSE;
        
        // Your logic here.
        
        return $result;
    }
}
```
